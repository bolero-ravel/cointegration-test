import pandas as pd
import numpy as np
import scipy.stats
import pandas_datareader as pdr
import itertools
from datetime import datetime, timedelta, date
import statsmodels.api as sm
from statsmodels.regression.rolling import RollingOLS
from arch.unitroot import engle_granger
import warnings
import csv
import pandas as pd

#read symbols and stock price data 
data = pd.read_csv("all symbol list.csv", header=None).values.tolist()
df_bf= pd.read_excel('all bf5 covid.xlsx',index_col = 'Dates')

# selects pairs based on correlation test
#symbols passed ADFtest
symbList = ['1301 JP Equity', '1332 JP Equity', '1333 JP Equity', '1352 JP Equity', '1375 JP Equity', '1376 JP Equity', '1377 JP Equity', '1379 JP Equity', '1384 JP Equity', '1413 JP Equity', '1414 JP Equity', '1417 JP Equity', '1419 JP Equity', '1420 JP Equity', '1429 JP Equity', '1430 JP Equity', '1433 JP Equity', '1435 JP Equity', '1446 JP Equity', '1448 JP Equity', '1514 JP Equity', '1515 JP Equity', '1518 JP Equity', '1605 JP Equity', '1662 JP Equity', '1663 JP Equity', '1712 JP Equity', '1716 JP Equity', '1717 JP Equity', '1719 JP Equity', '1720 JP Equity', '1721 JP Equity', '1726 JP Equity', '1762 JP Equity', '1766 JP Equity', '1768 JP Equity', '1780 JP Equity', '1786 JP Equity', '1801 JP Equity', '1802 JP Equity', '1803 JP Equity', '1805 JP Equity', '1808 JP Equity', '1810 JP Equity', '1811 JP Equity', '1812 JP Equity', '1813 JP Equity', '1814 JP Equity', '1815 JP Equity', '1820 JP Equity', '1821 JP Equity', '1822 JP Equity', '1824 JP Equity', '1826 JP Equity', '1827 JP Equity', '1833 JP Equity', '1835 JP Equity', '1847 JP Equity', '1848 JP Equity', '1852 JP Equity', '1860 JP Equity', '1861 JP Equity', '1866 JP Equity', '1867 JP Equity', '1870 JP Equity', '1871 JP Equity', '1873 JP Equity', '1878 JP Equity', '1879 JP Equity', '1881 JP Equity', '1882 JP Equity', '1883 JP Equity', '1884 JP Equity', '1885 JP Equity', '1887 JP Equity', '1888 JP Equity', '1890 JP Equity', '1893 JP Equity', '1898 JP Equity', '1899 JP Equity', '1909 JP Equity', '1911 JP Equity', '1914 JP Equity', '1921 JP Equity', '1925 JP Equity', '1926 JP Equity', '1928 JP Equity', '1929 JP Equity', '1930 JP Equity', '1934 JP Equity', '1938 JP Equity', '1939 JP Equity', '1941 JP Equity', '1942 JP Equity', '1944 JP Equity', '1945 JP Equity', '1946 JP Equity', '1949 JP Equity', '1950 JP Equity', '1951 JP Equity', '1952 JP Equity', '1954 JP Equity', '1959 JP Equity', '1961 JP Equity', '1963 JP Equity', '1964 JP Equity', '1967 JP Equity', '1968 JP Equity', '1969 JP Equity', '1972 JP Equity', '1973 JP Equity', '1975 JP Equity', '1976 JP Equity', '1979 JP Equity', '1980 JP Equity', '1982 JP Equity', '2001 JP Equity', '2002 JP Equity', '2003 JP Equity', '2004 JP Equity', '2009 JP Equity', '2053 JP Equity', '2060 JP Equity', '2107 JP Equity', '2108 JP Equity', '2109 JP Equity', '2112 JP Equity', '2117 JP Equity', '2120 JP Equity', '2121 JP Equity', '2124 JP Equity', '2127 JP Equity', '2130 JP Equity', '2139 JP Equity', '2146 JP Equity', '2148 JP Equity', '2151 JP Equity', '2153 JP Equity', '2154 JP Equity', '2157 JP Equity', '2163 JP Equity', '2168 JP Equity', '2169 JP Equity', '2170 JP Equity', '2174 JP Equity', '2175 JP Equity', '2180 JP Equity', '2181 JP Equity', '2183 JP Equity', '2193 JP Equity', '2196 JP Equity', '2198 JP Equity', '2201 JP Equity', '2204 JP Equity', '2206 JP Equity', '2207 JP Equity', '2209 JP Equity', '2211 JP Equity', '2212 JP Equity', '2215 JP Equity', '2217 JP Equity', '2220 JP Equity', '2222 JP Equity', '2229 JP Equity', '2264 JP Equity', '2266 JP Equity', '2267 JP Equity', '2269 JP Equity', '2270 JP Equity', '2281 JP Equity', '2282 JP Equity', '2286 JP Equity', '2288 JP Equity', '2292 JP Equity', '2294 JP Equity', '2296 JP Equity', '2301 JP Equity', '2305 JP Equity', '2307 JP Equity', '2309 JP Equity', '2311 JP Equity', '2317 JP Equity', '2325 JP Equity', '2326 JP Equity', '2327 JP Equity', '2331 JP Equity', '2335 JP Equity', '2337 JP Equity', '2352 JP Equity', '2353 JP Equity', '2359 JP Equity', '2371 JP Equity', '2372 JP Equity', '2374 JP Equity', '2376 JP Equity', '2378 JP Equity', '2379 JP Equity', '2384 JP Equity', '2389 JP Equity', '2395 JP Equity', '2398 JP Equity', '2410 JP Equity', '2412 JP Equity', '2413 JP Equity', '2418 JP Equity', '2424 JP Equity', '2427 JP Equity', '2428 JP Equity', '2429 JP Equity', '2432 JP Equity', '2433 JP Equity', '2440 JP Equity', '2445 JP Equity', '2453 JP Equity', '2461 JP Equity', '2462 JP Equity', '2464 JP Equity', '2471 JP Equity', '2475 JP Equity', '2477 JP Equity', '2485 JP Equity', '2487 JP Equity', '2489 JP Equity', '2491 JP Equity', '2492 JP Equity', '2501 JP Equity', '2502 JP Equity', '2503 JP Equity', '2531 JP Equity', '2533 JP Equity', '2540 JP Equity', '2579 JP Equity', '2587 JP Equity', '2590 JP Equity', '2593 JP Equity', '25935 JP Equity', '2594 JP Equity', '2597 JP Equity', '2599 JP Equity', '2602 JP Equity', '2607 JP Equity', '2612 JP Equity', '2613 JP Equity', '2651 JP Equity', '2659 JP Equity', '2664 JP Equity', '2670 JP Equity', '2674 JP Equity', '2676 JP Equity', '2678 JP Equity', '2681 JP Equity', '2685 JP Equity', '2686 JP Equity', '2687 JP Equity', '2689 JP Equity', '2692 JP Equity', '2695 JP Equity', '2698 JP Equity', '2715 JP Equity', '2722 JP Equity', '2726 JP Equity', '2729 JP Equity', '2730 JP Equity', '2733 JP Equity', '2734 JP Equity', '2735 JP Equity', '2737 JP Equity', '2742 JP Equity', '2749 JP Equity', '2752 JP Equity', '2753 JP Equity', '2760 JP Equity', '2764 JP Equity', '2767 JP Equity', '2768 JP Equity', '2784 JP Equity', '2791 JP Equity', '2792 JP Equity', '2796 JP Equity', '2801 JP Equity', '2802 JP Equity', '2804 JP Equity', '2809 JP Equity', '2810 JP Equity', '2811 JP Equity', '2812 JP Equity', '2815 JP Equity', '2818 JP Equity', '2819 JP Equity', '2820 JP Equity', '2871 JP Equity', '2874 JP Equity', '2875 JP Equity', '2882 JP Equity', '2883 JP Equity', '2884 JP Equity', '2897 JP Equity', '2899 JP Equity', '2904 JP Equity', '2908 JP Equity', '2910 JP Equity', '2914 JP Equity', '2915 JP Equity', '2918 JP Equity', '2922 JP Equity', '2924 JP Equity', '2925 JP Equity', '2929 JP Equity', '2930 JP Equity', '2931 JP Equity', '2933 JP Equity', '2975 JP Equity', '2980 JP Equity', '2982 JP Equity', '3001 JP Equity', '3002 JP Equity', '3003 JP Equity', '3004 JP Equity', '3023 JP Equity', '3028 JP Equity', '3030 JP Equity', '3031 JP Equity', '3034 JP Equity', '3036 JP Equity', '3038 JP Equity', '3040 JP Equity', '3046 JP Equity', '3048 JP Equity', '3050 JP Equity', '3053 JP Equity', '3054 JP Equity', '3064 JP Equity', '3067 JP Equity', '3073 JP Equity', '3076 JP Equity', '3079 JP Equity', '3082 JP Equity', '3085 JP Equity', '3086 JP Equity', '3087 JP Equity', '3088 JP Equity', '3091 JP Equity', '3092 JP Equity', '3093 JP Equity', '3097 JP Equity', '3098 JP Equity', '3099 JP Equity', '3101 JP Equity', '3103 JP Equity', '3104 JP Equity', '3105 JP Equity', '3106 JP Equity', '3107 JP Equity', '3109 JP Equity', '3110 JP Equity', '3116 JP Equity', '3132 JP Equity', '3134 JP Equity', '3135 JP Equity', '3139 JP Equity', '3141 JP Equity', '3148 JP Equity', '3150 JP Equity', '3151 JP Equity', '3153 JP Equity', '3154 JP Equity', '3156 JP Equity', '3157 JP Equity', '3159 JP Equity', '3160 JP Equity', '3166 JP Equity', '3167 JP Equity', '3168 JP Equity', '3169 JP Equity', '3172 JP Equity', '3173 JP Equity', '3175 JP Equity', '3176 JP Equity', '3178 JP Equity', '3179 JP Equity', '3180 JP Equity', '3182 JP Equity', '3183 JP Equity', '3186 JP Equity', '3191 JP Equity', '3193 JP Equity', '3196 JP Equity', '3197 JP Equity', '3198 JP Equity', '3199 JP Equity', '3201 JP Equity', '3202 JP Equity', '3204 JP Equity', '3205 JP Equity', '3221 JP Equity', '3222 JP Equity', '3228 JP Equity', '3231 JP Equity', '3232 JP Equity', '3244 JP Equity', '3245 JP Equity', '3246 JP Equity', '3252 JP Equity', '3254 JP Equity', '3267 JP Equity', '3271 JP Equity', '3275 JP Equity', '3276 JP Equity', '3277 JP Equity', '3280 JP Equity', '3284 JP Equity', '3288 JP Equity', '3289 JP Equity', '3291 JP Equity', '3294 JP Equity', '3299 JP Equity', '3302 JP Equity', '3315 JP Equity', '3319 JP Equity', '3321 JP Equity', '3328 JP Equity', '3333 JP Equity', '3341 JP Equity', '3349 JP Equity', '3360 JP Equity', '3361 JP Equity', '3371 JP Equity', '3376 JP Equity', '3382 JP Equity', '3387 JP Equity', '3388 JP Equity', '3391 JP Equity', '3392 JP Equity', '3393 JP Equity', '3395 JP Equity', '3396 JP Equity', '3397 JP Equity', '3401 JP Equity', '3402 JP Equity', '3405 JP Equity', '3407 JP Equity', '3408 JP Equity', '3415 JP Equity', '3421 JP Equity', '3431 JP Equity', '3433 JP Equity', '3434 JP Equity', '3436 JP Equity', '3443 JP Equity', '3445 JP Equity', '3446 JP Equity', '3447 JP Equity', '3452 JP Equity', '3454 JP Equity', '3457 JP Equity', '3458 JP Equity', '3464 JP Equity', '3465 JP Equity', '3467 JP Equity', '3475 JP Equity', '3480 JP Equity', '3484 JP Equity', '3486 JP Equity', '3489 JP Equity', '3501 JP Equity', '3512 JP Equity', '3513 JP Equity', '3521 JP Equity', '3524 JP Equity', '3526 JP Equity', '3529 JP Equity', '3538 JP Equity', '3539 JP Equity', '3543 JP Equity', '3544 JP Equity', '3546 JP Equity', '3547 JP Equity', '3548 JP Equity', '3549 JP Equity', '3551 JP Equity', '3553 JP Equity', '3559 JP Equity', '3561 JP Equity', '3563 JP Equity', '3565 JP Equity', '3569 JP Equity', '3571 JP Equity', '3577 JP Equity', '3580 JP Equity', '3591 JP Equity', '3593 JP Equity', '3607 JP Equity', '3608 JP Equity', '3611 JP Equity', '3612 JP Equity', '3626 JP Equity', '3627 JP Equity', '3630 JP Equity', '3632 JP Equity', '3633 JP Equity', '3635 JP Equity', '3636 JP Equity', '3639 JP Equity', '3640 JP Equity', '3648 JP Equity', '3649 JP Equity', '3655 JP Equity', '3656 JP Equity', '3657 JP Equity', '3658 JP Equity', '3659 JP Equity', '3660 JP Equity', '3661 JP Equity', '3662 JP Equity', '3665 JP Equity', '3666 JP Equity', '3667 JP Equity', '3668 JP Equity', '3672 JP Equity', '3673 JP Equity', '3675 JP Equity', '3676 JP Equity', '3677 JP Equity', '3678 JP Equity', '3679 JP Equity', '3681 JP Equity', '3682 JP Equity', '3683 JP Equity', '3686 JP Equity', '3687 JP Equity', '3688 JP Equity', '3694 JP Equity', '3696 JP Equity', '3697 JP Equity', '3708 JP Equity', '3738 JP Equity', '3741 JP Equity', '3751 JP Equity', '3762 JP Equity', '3763 JP Equity', '3765 JP Equity', '3769 JP Equity', '3770 JP Equity', '3771 JP Equity', '3774 JP Equity', '3778 JP Equity', '3784 JP Equity', '3788 JP Equity', '3817 JP Equity', '3826 JP Equity', '3834 JP Equity', '3835 JP Equity', '3836 JP Equity', '3837 JP Equity', '3839 JP Equity', '3843 JP Equity', '3844 JP Equity', '3852 JP Equity', '3853 JP Equity', '3854 JP Equity', '3861 JP Equity', '3863 JP Equity', '3864 JP Equity', '3865 JP Equity', '3877 JP Equity', '3878 JP Equity', '3880 JP Equity', '3896 JP Equity', '3901 JP Equity', '3902 JP Equity', '3903 JP Equity', '3909 JP Equity', '3912 JP Equity', '3915 JP Equity', '3916 JP Equity', '3918 JP Equity', '3919 JP Equity', '3920 JP Equity', '3921 JP Equity', '3922 JP Equity', '3923 JP Equity', '3924 JP Equity', '3925 JP Equity', '3926 JP Equity', '3928 JP Equity', '3932 JP Equity', '3934 JP Equity', '3937 JP Equity', '3939 JP Equity', '3940 JP Equity', '3941 JP Equity', '3946 JP Equity', '3950 JP Equity', '3962 JP Equity', '3963 JP Equity', '3964 JP Equity', '3965 JP Equity', '3968 JP Equity', '3969 JP Equity', '3975 JP Equity', '3978 JP Equity', '3981 JP Equity', '3983 JP Equity', '3984 JP Equity', '3985 JP Equity', '3992 JP Equity', '3996 JP Equity', '4004 JP Equity', '4005 JP Equity', '4008 JP Equity', '4021 JP Equity', '4022 JP Equity', '4023 JP Equity', '4025 JP Equity', '4027 JP Equity', '4028 JP Equity', '4031 JP Equity', '4041 JP Equity', '4042 JP Equity', '4043 JP Equity', '4044 JP Equity', '4045 JP Equity', '4046 JP Equity', '4047 JP Equity', '4061 JP Equity', '4062 JP Equity', '4063 JP Equity', '4064 JP Equity', '4078 JP Equity', '4082 JP Equity', '4088 JP Equity', '4091 JP Equity', '4092 JP Equity', '4093 JP Equity', '4095 JP Equity', '4097 JP Equity', '4098 JP Equity', '4099 JP Equity', '4100 JP Equity', '4109 JP Equity', '4112 JP Equity', '4114 JP Equity', '4116 JP Equity', '4118 JP Equity', '4151 JP Equity', '4182 JP Equity', '4183 JP Equity', '4185 JP Equity', '4186 JP Equity', '4187 JP Equity', '4188 JP Equity', '4189 JP Equity', '4202 JP Equity', '4203 JP Equity', '4204 JP Equity', '4205 JP Equity', '4206 JP Equity', '4208 JP Equity', '4212 JP Equity', '4215 JP Equity', '4216 JP Equity', '4218 JP Equity', '4220 JP Equity', '4221 JP Equity', '4228 JP Equity', '4229 JP Equity', '4231 JP Equity', '4238 JP Equity', '4245 JP Equity', '4246 JP Equity', '4248 JP Equity', '4249 JP Equity', '4251 JP Equity', '4272 JP Equity', '4275 JP Equity', '4282 JP Equity', '4284 JP Equity', '4286 JP Equity', '4290 JP Equity', '4295 JP Equity', '4298 JP Equity', '4299 JP Equity', '4301 JP Equity', '4307 JP Equity', '4310 JP Equity', '4312 JP Equity', '4318 JP Equity', '4319 JP Equity', '4320 JP Equity', '4323 JP Equity', '4324 JP Equity', '4326 JP Equity', '4331 JP Equity', '4333 JP Equity', '4337 JP Equity', '4343 JP Equity', '4344 JP Equity', '4345 JP Equity', '4346 JP Equity', '4348 JP Equity', '4350 JP Equity', '4362 JP Equity', '4368 JP Equity', '4369 JP Equity', '4382 JP Equity', '4384 JP Equity', '4390 JP Equity', '4392 JP Equity', '4396 JP Equity', '4401 JP Equity', '4403 JP Equity', '4404 JP Equity', '4406 JP Equity', '4410 JP Equity', '4420 JP Equity', '4423 JP Equity', '4427 JP Equity', '4430 JP Equity', '4432 JP Equity', '4433 JP Equity', '4434 JP Equity', '4439 JP Equity', '4440 JP Equity', '4441 JP Equity', '4443 JP Equity', '4446 JP Equity', '4449 JP Equity', '4452 JP Equity', '4461 JP Equity', '4462 JP Equity', '4463 JP Equity', '4465 JP Equity', '4471 JP Equity', '4481 JP Equity', '4502 JP Equity', '4503 JP Equity', '4506 JP Equity', '4507 JP Equity', '4512 JP Equity', '4516 JP Equity', '4517 JP Equity', '4519 JP Equity', '4521 JP Equity', '4523 JP Equity', '4526 JP Equity', '4527 JP Equity', '4528 JP Equity', '4530 JP Equity', '4531 JP Equity', '4534 JP Equity', '4536 JP Equity', '4538 JP Equity', '4539 JP Equity', '4540 JP Equity', '4541 JP Equity', '4543 JP Equity', '4544 JP Equity', '4547 JP Equity', '4548 JP Equity', '4549 JP Equity', '4550 JP Equity', '4551 JP Equity', '4552 JP Equity', '4553 JP Equity', '4554 JP Equity', '4559 JP Equity', '4568 JP Equity', '4569 JP Equity', '4574 JP Equity', '4577 JP Equity', '4578 JP Equity', '4581 JP Equity', '4587 JP Equity', '4611 JP Equity', '4612 JP Equity', '4613 JP Equity', '4615 JP Equity', '4617 JP Equity', '4619 JP Equity', '4620 JP Equity', '4626 JP Equity', '4631 JP Equity', '4633 JP Equity', '4634 JP Equity', '4636 JP Equity', '4641 JP Equity', '4651 JP Equity', '4653 JP Equity', '4658 JP Equity', '4661 JP Equity', '4662 JP Equity', '4665 JP Equity', '4666 JP Equity', '4668 JP Equity', '4671 JP Equity', '4674 JP Equity', '4676 JP Equity', '4678 JP Equity', '4679 JP Equity', '4680 JP Equity', '4681 JP Equity', '4684 JP Equity', '4686 JP Equity', '4687 JP Equity', '4689 JP Equity', '4694 JP Equity', '4696 JP Equity', '4704 JP Equity', '4708 JP Equity', '4709 JP Equity', '4714 JP Equity', '4716 JP Equity', '4718 JP Equity', '4719 JP Equity', '4722 JP Equity', '4725 JP Equity', '4726 JP Equity', '4728 JP Equity', '4732 JP Equity', '4733 JP Equity', '4739 JP Equity', '4743 JP Equity', '4745 JP Equity', '4746 JP Equity', '4751 JP Equity', '4755 JP Equity', '4762 JP Equity', '4763 JP Equity', '4765 JP Equity', '4767 JP Equity', '4768 JP Equity', '4776 JP Equity', '4792 JP Equity', '4801 JP Equity', '4809 JP Equity', '4812 JP Equity', '4813 JP Equity', '4819 JP Equity', '4820 JP Equity', '4825 JP Equity', '4826 JP Equity', '4828 JP Equity', '4829 JP Equity', '4839 JP Equity', '4845 JP Equity', '4847 JP Equity', '4848 JP Equity', '4849 JP Equity', '4886 JP Equity', '4887 JP Equity', '4901 JP Equity', '4902 JP Equity', '4911 JP Equity', '4912 JP Equity', '4914 JP Equity', '4917 JP Equity', '4919 JP Equity', '4921 JP Equity', '4922 JP Equity', '4923 JP Equity', '4926 JP Equity', '4927 JP Equity', '4928 JP Equity', '4929 JP Equity', '4931 JP Equity', '4951 JP Equity', '4955 JP Equity', '4956 JP Equity', '4958 JP Equity', '4963 JP Equity', '4967 JP Equity', '4968 JP Equity', '4971 JP Equity', '4973 JP Equity', '4974 JP Equity', '4975 JP Equity', '4977 JP Equity', '4979 JP Equity', '4980 JP Equity', '4985 JP Equity', '4992 JP Equity', '4994 JP Equity', '4996 JP Equity', '4997 JP Equity', '5009 JP Equity', '5011 JP Equity', '5013 JP Equity', '5015 JP Equity', '5017 JP Equity', '5018 JP Equity', '5019 JP Equity', '5020 JP Equity', '5021 JP Equity', '5074 JP Equity', '5101 JP Equity', '5105 JP Equity', '5108 JP Equity', '5110 JP Equity', '5121 JP Equity', '5122 JP Equity', '5142 JP Equity', '5185 JP Equity', '5186 JP Equity', '5187 JP Equity', '5191 JP Equity', '5192 JP Equity', '5195 JP Equity', '5201 JP Equity', '5202 JP Equity', '5204 JP Equity', '5208 JP Equity', '5210 JP Equity', '5214 JP Equity', '5218 JP Equity', '5232 JP Equity', '5233 JP Equity', '5261 JP Equity', '5262 JP Equity', '5269 JP Equity', '5273 JP Equity', '5288 JP Equity', '5301 JP Equity', '5302 JP Equity', '5310 JP Equity', '5331 JP Equity', '5332 JP Equity', '5333 JP Equity', '5334 JP Equity', '5337 JP Equity', '5344 JP Equity', '5351 JP Equity', '5352 JP Equity', '5357 JP Equity', '5358 JP Equity', '5363 JP Equity', '5367 JP Equity', '5384 JP Equity', '5388 JP Equity', '5391 JP Equity', '5393 JP Equity', '5401 JP Equity', '5406 JP Equity', '5408 JP Equity', '5410 JP Equity', '5411 JP Equity', '5423 JP Equity', '5440 JP Equity', '5444 JP Equity', '5445 JP Equity', '5449 JP Equity', '5451 JP Equity', '5463 JP Equity', '5464 JP Equity', '5471 JP Equity', '5476 JP Equity', '5480 JP Equity', '5481 JP Equity', '5482 JP Equity', '5486 JP Equity', '5491 JP Equity', '5541 JP Equity', '5563 JP Equity', '5602 JP Equity', '5603 JP Equity', '5612 JP Equity', '5631 JP Equity', '5632 JP Equity', '5658 JP Equity', '5659 JP Equity', '5698 JP Equity', '5702 JP Equity', '5703 JP Equity', '5706 JP Equity', '5707 JP Equity', '5711 JP Equity', '5713 JP Equity', '5714 JP Equity', '5715 JP Equity', '5721 JP Equity', '5726 JP Equity', '5727 JP Equity', '5741 JP Equity', '5757 JP Equity', '5801 JP Equity', '5802 JP Equity', '5803 JP Equity', '5805 JP Equity', '5807 JP Equity', '5809 JP Equity', '5819 JP Equity', '5821 JP Equity', '5851 JP Equity', '5852 JP Equity', '5857 JP Equity', '5901 JP Equity', '5902 JP Equity', '5909 JP Equity', '5911 JP Equity', '5915 JP Equity', '5923 JP Equity', '5929 JP Equity', '5930 JP Equity', '5932 JP Equity', '5933 JP Equity', '5936 JP Equity', '5938 JP Equity', '5942 JP Equity', '5943 JP Equity', '5946 JP Equity', '5947 JP Equity', '5949 JP Equity', '5951 JP Equity', '5957 JP Equity', '5958 JP Equity', '5959 JP Equity', '5970 JP Equity', '5975 JP Equity', '5976 JP Equity', '5981 JP Equity', '5985 JP Equity', '5986 JP Equity', '5988 JP Equity', '5989 JP Equity', '5991 JP Equity', '5992 JP Equity', '5998 JP Equity', '6005 JP Equity', '6013 JP Equity', '6028 JP Equity', '6029 JP Equity', '6032 JP Equity', '6035 JP Equity', '6036 JP Equity', '6037 JP Equity', '6044 JP Equity', '6047 JP Equity', '6048 JP Equity', '6050 JP Equity', '6054 JP Equity', '6055 JP Equity', '6058 JP Equity', '6059 JP Equity', '6062 JP Equity', '6070 JP Equity', '6071 JP Equity', '6073 JP Equity', '6077 JP Equity', '6078 JP Equity', '6080 JP Equity', '6082 JP Equity', '6083 JP Equity', '6087 JP Equity', '6088 JP Equity', '6089 JP Equity', '6093 JP Equity', '6095 JP Equity', '6096 JP Equity', '6098 JP Equity', '6099 JP Equity', '6101 JP Equity', '6103 JP Equity', '6104 JP Equity', '6113 JP Equity', '6118 JP Equity', '6121 JP Equity', '6134 JP Equity', '6135 JP Equity', '6136 JP Equity', '6138 JP Equity', '6140 JP Equity', '6141 JP Equity', '6143 JP Equity', '6146 JP Equity', '6151 JP Equity', '6157 JP Equity', '6165 JP Equity', '6167 JP Equity', '6171 JP Equity', '6175 JP Equity', '6178 JP Equity', '6183 JP Equity', '6184 JP Equity', '6185 JP Equity', '6186 JP Equity', '6189 JP Equity', '6191 JP Equity', '6194 JP Equity', '6196 JP Equity', '6197 JP Equity', '6199 JP Equity', '6200 JP Equity', '6201 JP Equity', '6203 JP Equity', '6205 JP Equity', '6208 JP Equity', '6210 JP Equity', '6217 JP Equity', '6218 JP Equity', '6222 JP Equity', '6235 JP Equity', '6236 JP Equity', '6237 JP Equity', '6238 JP Equity', '6240 JP Equity', '6247 JP Equity', '6250 JP Equity', '6258 JP Equity', '6262 JP Equity', '6264 JP Equity', '6266 JP Equity', '6268 JP Equity', '6269 JP Equity', '6272 JP Equity', '6273 JP Equity', '6277 JP Equity', '6278 JP Equity', '6282 JP Equity', '6284 JP Equity', '6287 JP Equity', '6289 JP Equity', '6291 JP Equity', '6292 JP Equity', '6293 JP Equity', '6294 JP Equity', '6298 JP Equity', '6301 JP Equity', '6302 JP Equity', '6305 JP Equity', '6306 JP Equity', '6309 JP Equity', '6310 JP Equity', '6315 JP Equity', '6316 JP Equity', '6317 JP Equity', '6319 JP Equity', '6323 JP Equity', '6325 JP Equity', '6326 JP Equity', '6328 JP Equity', '6330 JP Equity', '6331 JP Equity', '6332 JP Equity', '6333 JP Equity', '6335 JP Equity', '6339 JP Equity', '6340 JP Equity', '6345 JP Equity', '6349 JP Equity', '6351 JP Equity', '6355 JP Equity', '6356 JP Equity', '6358 JP Equity', '6361 JP Equity', '6362 JP Equity', '6363 JP Equity', '6364 JP Equity', '6367 JP Equity', '6368 JP Equity', '6369 JP Equity', '6370 JP Equity', '6371 JP Equity', '6373 JP Equity', '6376 JP Equity', '6378 JP Equity', '6379 JP Equity', '6381 JP Equity', '6383 JP Equity', '6387 JP Equity', '6390 JP Equity', '6393 JP Equity', '6395 JP Equity', '6406 JP Equity', '6407 JP Equity', '6409 JP Equity', '6412 JP Equity', '6413 JP Equity', '6417 JP Equity', '6418 JP Equity', '6419 JP Equity', '6420 JP Equity', '6428 JP Equity', '6430 JP Equity', '6432 JP Equity', '6436 JP Equity', '6440 JP Equity', '6444 JP Equity', '6445 JP Equity', '6448 JP Equity', '6454 JP Equity', '6455 JP Equity', '6457 JP Equity', '6458 JP Equity', '6459 JP Equity', '6460 JP Equity', '6461 JP Equity', '6462 JP Equity', '6463 JP Equity', '6464 JP Equity', '6465 JP Equity', '6470 JP Equity', '6471 JP Equity', '6472 JP Equity', '6473 JP Equity', '6474 JP Equity', '6479 JP Equity', '6480 JP Equity', '6481 JP Equity', '6482 JP Equity', '6485 JP Equity', '6486 JP Equity', '6489 JP Equity', '6490 JP Equity', '6498 JP Equity', '6501 JP Equity', '6502 JP Equity', '6503 JP Equity', '6504 JP Equity', '6505 JP Equity', '6506 JP Equity', '6507 JP Equity', '6508 JP Equity', '6513 JP Equity', '6516 JP Equity', '6517 JP Equity', '6532 JP Equity', '6533 JP Equity', '6535 JP Equity', '6538 JP Equity', '6539 JP Equity', '6540 JP Equity', '6541 JP Equity', '6544 JP Equity', '6546 JP Equity', '6547 JP Equity', '6551 JP Equity', '6552 JP Equity', '6553 JP Equity', '6555 JP Equity', '6556 JP Equity', '6560 JP Equity', '6564 JP Equity', '6569 JP Equity', '6571 JP Equity', '6572 JP Equity', '6584 JP Equity', '6586 JP Equity', '6588 JP Equity', '6590 JP Equity', '6592 JP Equity', '6594 JP Equity', '6615 JP Equity', '6616 JP Equity', '6617 JP Equity', '6619 JP Equity', '6620 JP Equity', '6622 JP Equity', '6630 JP Equity', '6632 JP Equity', '6638 JP Equity', '6640 JP Equity', '6641 JP Equity', '6644 JP Equity', '6645 JP Equity', '6651 JP Equity', '6652 JP Equity', '6653 JP Equity', '6654 JP Equity', '6674 JP Equity', '6675 JP Equity', '6676 JP Equity', '6678 JP Equity', '6699 JP Equity', '6701 JP Equity', '6702 JP Equity', '6703 JP Equity', '6704 JP Equity', '6706 JP Equity', '6707 JP Equity', '6715 JP Equity', '6718 JP Equity', '6723 JP Equity', '6724 JP Equity', '6727 JP Equity', '6728 JP Equity', '6730 JP Equity', '6737 JP Equity', '6740 JP Equity', '6741 JP Equity', '6742 JP Equity', '6744 JP Equity', '6745 JP Equity', '6748 JP Equity', '6750 JP Equity', '6752 JP Equity', '6753 JP Equity', '6754 JP Equity', '6755 JP Equity', '6758 JP Equity', '6762 JP Equity', '6763 JP Equity', '6768 JP Equity', '6770 JP Equity', '6771 JP Equity', '6779 JP Equity', '6785 JP Equity', '6788 JP Equity', '6789 JP Equity', '6794 JP Equity', '6798 JP Equity', '6800 JP Equity', '6803 JP Equity', '6804 JP Equity', '6806 JP Equity', '6807 JP Equity', '6809 JP Equity', '6810 JP Equity', '6814 JP Equity', '6815 JP Equity', '6817 JP Equity', '6820 JP Equity', '6823 JP Equity', '6826 JP Equity', '6839 JP Equity', '6841 JP Equity', '6844 JP Equity', '6845 JP Equity', '6848 JP Equity', '6849 JP Equity', '6850 JP Equity', '6853 JP Equity', '6855 JP Equity', '6856 JP Equity', '6857 JP Equity', '6858 JP Equity', '6859 JP Equity', '6861 JP Equity', '6866 JP Equity', '6869 JP Equity', '6871 JP Equity', '6875 JP Equity', '6877 JP Equity', '6879 JP Equity', '6901 JP Equity', '6902 JP Equity', '6904 JP Equity', '6905 JP Equity', '6908 JP Equity', '6914 JP Equity', '6915 JP Equity', '6916 JP Equity', '6920 JP Equity', '6923 JP Equity', '6924 JP Equity', '6925 JP Equity', '6926 JP Equity', '6927 JP Equity', '6928 JP Equity', '6929 JP Equity', '6932 JP Equity', '6937 JP Equity', '6938 JP Equity', '6941 JP Equity', '6947 JP Equity', '6951 JP Equity', '6952 JP Equity', '6954 JP Equity', '6958 JP Equity', '6961 JP Equity', '6962 JP Equity', '6963 JP Equity', '6965 JP Equity', '6966 JP Equity', '6967 JP Equity', '6971 JP Equity', '6973 JP Equity', '6976 JP Equity', '6981 JP Equity', '6986 JP Equity', '6988 JP Equity', '6989 JP Equity', '6995 JP Equity', '6996 JP Equity', '6997 JP Equity', '6999 JP Equity', '7003 JP Equity', '7004 JP Equity', '7011 JP Equity', '7012 JP Equity', '7013 JP Equity', '7014 JP Equity', '7022 JP Equity', '7030 JP Equity', '7033 JP Equity', '7034 JP Equity', '7035 JP Equity', '7037 JP Equity', '7038 JP Equity', '7044 JP Equity', '7059 JP Equity', '7060 JP Equity', '7085 JP Equity', '7088 JP Equity', '7102 JP Equity', '7105 JP Equity', '7122 JP Equity', '7148 JP Equity', '7150 JP Equity', '7161 JP Equity', '7164 JP Equity', '7167 JP Equity', '7172 JP Equity', '7173 JP Equity', '7180 JP Equity', '7181 JP Equity', '7182 JP Equity', '7184 JP Equity', '7186 JP Equity', '7187 JP Equity', '7189 JP Equity', '7190 JP Equity', '7191 JP Equity', '7192 JP Equity', '7196 JP Equity', '7198 JP Equity', '7199 JP Equity', '7201 JP Equity', '7202 JP Equity', '7203 JP Equity', '7205 JP Equity', '7211 JP Equity', '7212 JP Equity', '7213 JP Equity', '7214 JP Equity', '7215 JP Equity', '7220 JP Equity', '7222 JP Equity', '7224 JP Equity', '7226 JP Equity', '7231 JP Equity', '7236 JP Equity', '7238 JP Equity', '7239 JP Equity', '7240 JP Equity', '7241 JP Equity', '7242 JP Equity', '7244 JP Equity', '7245 JP Equity', '7246 JP Equity', '7247 JP Equity', '7250 JP Equity', '7256 JP Equity', '7259 JP Equity', '7261 JP Equity', '7266 JP Equity', '7267 JP Equity', '7269 JP Equity', '7270 JP Equity', '7271 JP Equity', '7272 JP Equity', '7276 JP Equity', '7277 JP Equity', '7278 JP Equity', '7280 JP Equity', '7282 JP Equity', '7283 JP Equity', '7284 JP Equity', '7291 JP Equity', '7294 JP Equity', '7296 JP Equity', '7305 JP Equity', '7309 JP Equity', '7313 JP Equity', '7322 JP Equity', '7327 JP Equity', '7337 JP Equity', '7354 JP Equity', '7358 JP Equity', '7366 JP Equity', '7408 JP Equity', '7414 JP Equity', '7416 JP Equity', '7417 JP Equity', '7419 JP Equity', '7420 JP Equity', '7421 JP Equity', '7427 JP Equity', '7433 JP Equity', '7438 JP Equity', '7442 JP Equity', '7445 JP Equity', '7447 JP Equity', '7451 JP Equity', '7453 JP Equity', '7455 JP Equity', '7456 JP Equity', '7458 JP Equity', '7459 JP Equity', '7463 JP Equity', '7466 JP Equity', '7467 JP Equity', '7475 JP Equity', '7476 JP Equity', '7480 JP Equity', '7481 JP Equity', '7482 JP Equity', '7483 JP Equity', '7487 JP Equity', '7494 JP Equity', '7504 JP Equity', '7506 JP Equity', '7508 JP Equity', '7510 JP Equity', '7512 JP Equity', '7513 JP Equity', '7514 JP Equity', '7516 JP Equity', '7518 JP Equity', '7520 JP Equity', '7522 JP Equity', '7524 JP Equity', '7525 JP Equity', '7527 JP Equity', '7532 JP Equity', '7537 JP Equity', '7545 JP Equity', '7550 JP Equity', '7552 JP Equity', '7554 JP Equity', '7561 JP Equity', '7570 JP Equity', '7575 JP Equity', '7581 JP Equity', '7590 JP Equity', '7593 JP Equity', '7594 JP Equity', '7595 JP Equity', '7596 JP Equity', '7599 JP Equity', '7600 JP Equity', '7601 JP Equity', '7605 JP Equity', '7606 JP Equity', '7607 JP Equity', '7608 JP Equity', '7609 JP Equity', '7611 JP Equity', '7613 JP Equity', '7615 JP Equity', '7616 JP Equity', '7618 JP Equity', '7619 JP Equity', '7628 JP Equity', '7630 JP Equity', '7637 JP Equity', '7640 JP Equity', '7646 JP Equity', '7649 JP Equity', '7673 JP Equity', '7679 JP Equity', '7701 JP Equity', '7702 JP Equity', '7709 JP Equity', '7715 JP Equity', '7717 JP Equity', '7718 JP Equity', '7721 JP Equity', '7723 JP Equity', '7725 JP Equity', '7727 JP Equity', '7729 JP Equity', '7730 JP Equity', '7731 JP Equity', '7732 JP Equity', '7733 JP Equity', '7734 JP Equity', '7735 JP Equity', '7739 JP Equity', '7740 JP Equity', '7741 JP Equity', '7743 JP Equity', '7744 JP Equity', '7745 JP Equity', '7747 JP Equity', '7751 JP Equity', '7752 JP Equity', '7762 JP Equity', '7769 JP Equity', '7775 JP Equity', '7780 JP Equity', '7782 JP Equity', '7811 JP Equity', '7816 JP Equity', '7817 JP Equity', '7818 JP Equity', '7819 JP Equity', '7820 JP Equity', '7821 JP Equity', '7822 JP Equity', '7823 JP Equity', '7832 JP Equity', '7833 JP Equity', '7838 JP Equity', '7839 JP Equity', '7840 JP Equity', '7844 JP Equity', '7846 JP Equity', '7856 JP Equity', '7860 JP Equity', '7862 JP Equity', '7864 JP Equity', '7867 JP Equity', '7868 JP Equity', '7872 JP Equity', '7874 JP Equity', '7885 JP Equity', '7888 JP Equity', '7893 JP Equity', '7897 JP Equity', '7898 JP Equity', '7905 JP Equity', '7908 JP Equity', '7911 JP Equity', '7912 JP Equity', '7914 JP Equity', '7915 JP Equity', '7916 JP Equity', '7917 JP Equity', '7918 JP Equity', '7921 JP Equity', '7925 JP Equity', '7931 JP Equity', '7936 JP Equity', '7937 JP Equity', '7940 JP Equity', '7942 JP Equity', '7943 JP Equity', '7944 JP Equity', '7947 JP Equity', '7949 JP Equity', '7951 JP Equity', '7952 JP Equity', '7955 JP Equity', '7956 JP Equity', '7958 JP Equity', '7959 JP Equity', '7961 JP Equity', '7962 JP Equity', '7965 JP Equity', '7966 JP Equity', '7970 JP Equity', '7971 JP Equity', '7972 JP Equity', '7974 JP Equity', '7976 JP Equity', '7979 JP Equity', '7981 JP Equity', '7984 JP Equity', '7987 JP Equity', '7988 JP Equity', '7989 JP Equity', '7990 JP Equity', '7994 JP Equity', '7995 JP Equity', '7999 JP Equity', '8001 JP Equity', '8002 JP Equity', '8005 JP Equity', '8007 JP Equity', '8008 JP Equity', '8011 JP Equity', '8012 JP Equity', '8013 JP Equity', '8014 JP Equity', '8015 JP Equity', '8016 JP Equity', '8018 JP Equity', '8020 JP Equity', '8022 JP Equity', '8025 JP Equity', '8029 JP Equity', '8031 JP Equity', '8032 JP Equity', '8035 JP Equity', '8037 JP Equity', '8038 JP Equity', '8041 JP Equity', '8043 JP Equity', '8050 JP Equity', '8051 JP Equity', '8052 JP Equity', '8053 JP Equity', '8056 JP Equity', '8057 JP Equity', '8058 JP Equity', '8059 JP Equity', '8060 JP Equity', '8061 JP Equity', '8065 JP Equity', '8068 JP Equity', '8070 JP Equity', '8074 JP Equity', '8075 JP Equity', '8077 JP Equity', '8078 JP Equity', '8079 JP Equity', '8081 JP Equity', '8084 JP Equity', '8086 JP Equity', '8087 JP Equity', '8088 JP Equity', '8089 JP Equity', '8090 JP Equity', '8091 JP Equity', '8093 JP Equity', '8095 JP Equity', '8096 JP Equity', '8097 JP Equity', '8098 JP Equity', '8101 JP Equity', '8103 JP Equity', '8104 JP Equity', '8107 JP Equity', '8108 JP Equity', '8111 JP Equity', '8113 JP Equity', '8114 JP Equity', '8118 JP Equity', '8125 JP Equity', '8127 JP Equity', '8129 JP Equity', '8130 JP Equity', '8131 JP Equity', '8132 JP Equity', '8133 JP Equity', '8136 JP Equity', '8137 JP Equity', '8140 JP Equity', '8141 JP Equity', '8142 JP Equity', '8150 JP Equity', '8151 JP Equity', '8153 JP Equity', '8154 JP Equity', '8155 JP Equity', '8157 JP Equity', '8158 JP Equity', '8159 JP Equity', '8160 JP Equity', '8163 JP Equity', '8165 JP Equity', '8166 JP Equity', '8167 JP Equity', '8168 JP Equity', '8173 JP Equity', '8174 JP Equity', '8179 JP Equity', '8181 JP Equity', '8182 JP Equity', '8185 JP Equity', '8194 JP Equity', '8200 JP Equity', '8203 JP Equity', '8207 JP Equity', '8214 JP Equity', '8217 JP Equity', '8218 JP Equity', '8219 JP Equity', '8227 JP Equity', '8230 JP Equity', '8233 JP Equity', '8237 JP Equity', '8242 JP Equity', '8244 JP Equity', '8252 JP Equity', '8253 JP Equity', '8255 JP Equity', '8260 JP Equity', '8267 JP Equity', '8273 JP Equity', '8275 JP Equity', '8276 JP Equity', '8278 JP Equity', '8279 JP Equity', '8281 JP Equity', '8282 JP Equity', '8283 JP Equity', '8285 JP Equity', '8289 JP Equity', '8291 JP Equity', '8303 JP Equity', '8304 JP Equity', '8306 JP Equity', '8308 JP Equity', '8309 JP Equity', '8316 JP Equity', '8331 JP Equity', '8334 JP Equity', '8336 JP Equity', '8337 JP Equity', '8338 JP Equity', '8341 JP Equity', '8342 JP Equity', '8343 JP Equity', '8344 JP Equity', '8345 JP Equity', '8346 JP Equity', '8349 JP Equity', '8350 JP Equity', '8354 JP Equity', '8355 JP Equity', '8356 JP Equity', '8358 JP Equity', '8359 JP Equity', '8360 JP Equity', '8361 JP Equity', '8362 JP Equity', '8363 JP Equity', '8364 JP Equity', '8365 JP Equity', '8366 JP Equity', '8367 JP Equity', '8368 JP Equity', '8369 JP Equity', '8370 JP Equity', '8377 JP Equity', '8381 JP Equity', '8382 JP Equity', '8383 JP Equity', '8385 JP Equity', '8386 JP Equity', '8387 JP Equity', '8388 JP Equity', '8392 JP Equity', '8393 JP Equity', '8395 JP Equity', '8397 JP Equity', '8399 JP Equity', '8410 JP Equity', '8411 JP Equity', '8416 JP Equity', '8418 JP Equity', '8424 JP Equity', '8425 JP Equity', '8439 JP Equity', '8473 JP Equity', '8511 JP Equity', '8515 JP Equity', '8518 JP Equity', '8521 JP Equity', '8522 JP Equity', '8524 JP Equity', '8527 JP Equity', '8530 JP Equity', '8537 JP Equity', '8541 JP Equity', '8542 JP Equity', '8544 JP Equity', '8550 JP Equity', '8551 JP Equity', '8558 JP Equity', '8562 JP Equity', '8563 JP Equity', '8566 JP Equity', '8570 JP Equity', '8572 JP Equity', '8584 JP Equity', '8585 JP Equity', '8591 JP Equity', '8593 JP Equity', '8595 JP Equity', '8596 JP Equity', '8600 JP Equity', '8601 JP Equity', '8604 JP Equity', '8609 JP Equity', '8613 JP Equity', '8614 JP Equity', '8616 JP Equity', '8617 JP Equity', '8622 JP Equity', '8624 JP Equity', '8628 JP Equity', '8630 JP Equity', '8697 JP Equity', '8698 JP Equity', '8706 JP Equity', '8707 JP Equity', '8708 JP Equity', '8713 JP Equity', '8714 JP Equity', '8715 JP Equity', '8725 JP Equity', '8732 JP Equity', '8739 JP Equity', '8742 JP Equity', '8750 JP Equity', '8766 JP Equity', '8769 JP Equity', '8771 JP Equity', '8772 JP Equity', '8793 JP Equity', '8795 JP Equity', '8798 JP Equity', '8801 JP Equity', '8802 JP Equity', '8803 JP Equity', '8804 JP Equity', '8806 JP Equity', '8818 JP Equity', '8830 JP Equity', '8835 JP Equity', '8841 JP Equity', '8842 JP Equity', '8848 JP Equity', '8850 JP Equity', '8860 JP Equity', '8864 JP Equity', '8869 JP Equity', '8871 JP Equity', '8876 JP Equity', '8877 JP Equity', '8881 JP Equity', '8892 JP Equity', '8897 JP Equity', '8904 JP Equity', '8905 JP Equity', '8908 JP Equity', '8917 JP Equity', '8918 JP Equity', '8919 JP Equity', '8920 JP Equity', '8923 JP Equity', '8928 JP Equity', '8934 JP Equity', '8935 JP Equity', '8940 JP Equity', '8944 JP Equity', '8945 JP Equity', '8999 JP Equity', '9001 JP Equity', '9003 JP Equity', '9005 JP Equity', '9006 JP Equity', '9007 JP Equity', '9008 JP Equity', '9009 JP Equity', '9010 JP Equity', '9014 JP Equity', '9020 JP Equity', '9021 JP Equity', '9022 JP Equity', '9024 JP Equity', '9025 JP Equity', '9031 JP Equity', '9037 JP Equity', '9039 JP Equity', '9041 JP Equity', '9042 JP Equity', '9044 JP Equity', '9045 JP Equity', '9046 JP Equity', '9048 JP Equity', '9052 JP Equity', '9055 JP Equity', '9058 JP Equity', '9062 JP Equity', '9064 JP Equity', '9065 JP Equity', '9066 JP Equity', '9067 JP Equity', '9068 JP Equity', '9069 JP Equity', '9070 JP Equity', '9072 JP Equity', '9074 JP Equity', '9075 JP Equity', '9076 JP Equity', '9078 JP Equity', '9081 JP Equity', '9086 JP Equity', '9090 JP Equity', '9099 JP Equity', '9101 JP Equity', '9104 JP Equity', '9107 JP Equity', '9110 JP Equity', '9115 JP Equity', '9119 JP Equity', '9130 JP Equity', '9142 JP Equity', '9143 JP Equity', '9201 JP Equity', '9202 JP Equity', '9232 JP Equity', '9260 JP Equity', '9262 JP Equity', '9265 JP Equity', '9266 JP Equity', '9267 JP Equity', '9273 JP Equity', '9274 JP Equity', '9275 JP Equity', '9278 JP Equity', '9279 JP Equity', '9301 JP Equity', '9302 JP Equity', '9303 JP Equity', '9304 JP Equity', '9305 JP Equity', '9306 JP Equity', '9308 JP Equity', '9310 JP Equity', '9312 JP Equity', '9319 JP Equity', '9322 JP Equity', '9324 JP Equity', '9325 JP Equity', '9351 JP Equity', '9358 JP Equity', '9364 JP Equity', '9366 JP Equity', '9368 JP Equity', '9369 JP Equity', '9375 JP Equity', '9380 JP Equity', '9381 JP Equity', '9384 JP Equity', '9385 JP Equity', '9386 JP Equity', '9401 JP Equity', '9404 JP Equity', '9405 JP Equity', '9409 JP Equity', '9412 JP Equity', '9413 JP Equity', '9414 JP Equity', '9416 JP Equity', '9417 JP Equity', '9418 JP Equity', '9419 JP Equity', '9422 JP Equity', '9424 JP Equity', '9428 JP Equity', '9432 JP Equity', '9433 JP Equity', '9434 JP Equity', '9435 JP Equity', '9438 JP Equity', '9449 JP Equity', '9450 JP Equity', '9466 JP Equity', '9468 JP Equity', '9470 JP Equity', '9474 JP Equity', '9475 JP Equity', '9479 JP Equity', '9501 JP Equity', '9502 JP Equity', '9503 JP Equity', '9504 JP Equity', '9505 JP Equity', '9506 JP Equity', '9507 JP Equity', '9508 JP Equity', '9509 JP Equity', '9511 JP Equity', '9513 JP Equity', '9514 JP Equity', '9517 JP Equity', '9519 JP Equity', '9531 JP Equity', '9532 JP Equity', '9533 JP Equity', '9534 JP Equity', '9535 JP Equity', '9536 JP Equity', '9543 JP Equity', '9551 JP Equity', '9600 JP Equity', '9601 JP Equity', '9602 JP Equity', '9603 JP Equity', '9605 JP Equity', '9612 JP Equity', '9613 JP Equity', '9616 JP Equity', '9619 JP Equity', '9621 JP Equity', '9622 JP Equity', '9624 JP Equity', '9627 JP Equity', '9628 JP Equity', '9629 JP Equity', '9632 JP Equity', '9633 JP Equity', '9644 JP Equity', '9658 JP Equity', '9663 JP Equity', '9672 JP Equity', '9675 JP Equity', '9678 JP Equity', '9682 JP Equity', '9684 JP Equity', '9692 JP Equity', '9697 JP Equity', '9699 JP Equity', '9702 JP Equity', '9704 JP Equity', '9706 JP Equity', '9715 JP Equity', '9716 JP Equity', '9717 JP Equity', '9719 JP Equity', '9722 JP Equity', '9726 JP Equity', '9728 JP Equity', '9729 JP Equity', '9731 JP Equity', '9735 JP Equity', '9739 JP Equity', '9740 JP Equity', '9742 JP Equity', '9743 JP Equity', '9744 JP Equity', '9746 JP Equity', '9749 JP Equity', '9755 JP Equity', '9757 JP Equity', '9759 JP Equity', '9760 JP Equity', '9763 JP Equity', '9765 JP Equity', '9766 JP Equity', '9768 JP Equity', '9769 JP Equity', '9783 JP Equity', '9787 JP Equity', '9788 JP Equity', '9790 JP Equity', '9793 JP Equity', '9795 JP Equity', '9810 JP Equity', '9824 JP Equity', '9828 JP Equity', '9830 JP Equity', '9831 JP Equity', '9832 JP Equity', '9837 JP Equity', '9842 JP Equity', '9843 JP Equity', '9850 JP Equity', '9854 JP Equity', '9856 JP Equity', '9861 JP Equity', '9869 JP Equity', '9872 JP Equity', '9880 JP Equity', '9882 JP Equity', '9887 JP Equity', '9889 JP Equity', '9896 JP Equity', '9900 JP Equity', '9902 JP Equity', '9919 JP Equity', '9928 JP Equity', '9930 JP Equity', '9932 JP Equity', '9934 JP Equity', '9936 JP Equity', '9945 JP Equity', '9946 JP Equity', '9948 JP Equity', '9956 JP Equity', '9960 JP Equity', '9962 JP Equity', '9966 JP Equity', '9972 JP Equity', '9974 JP Equity', '9979 JP Equity', '9982 JP Equity', '9983 JP Equity', '9984 JP Equity', '9986 JP Equity', '9987 JP Equity', '9989 JP Equity', '9990 JP Equity', '9991 JP Equity', '9993 JP Equity', '9994 JP Equity', '9995 JP Equity', '9997 JP Equity']
symbol_pairs = list(itertools.combinations(symbList, 2))
corr_eff = 0.80
corr_pairs = []

def find_correlated_pairs(df_bf):
    for y, x in symbol_pairs:
            try:
                corr_test = scipy.stats.linregress(df_bf[y],df_bf[x])
                print(f'{y} - {x} : rvalue = {corr_test.rvalue}')
                if corr_test.rvalue > corr_eff:
                    corr_pairs.append((y, x, corr_test.rvalue))
            except:
                print(f'Nans detected. The pair: {y} - {x} will be skipped.')
    return corr_pairs

find_correlated_pairs(df_bf)
print(f'All the selected pairs with r-value lower or equal: {corr_eff} are: ')
for c, pair in enumerate(corr_pairs, 1):
    print(f'Pair : {pair[0]} - {pair[1]}, rvalue: {pair[2]}')

df_corr=pd.DataFrame(corr_pairs)
df_corr.columns = ['y','x','correff']
df_corr.to_csv('corr_pairs_tse1.csv')

# selects pairs based on Engle-Granger cointegration test 
symbList_corr_y = df_corr['y'].tolist()
symbList_corr_x = df_corr['x'].tolist()
significance_level = 0.05
coint_pairs = []
def find_cointegrated_pairs(df_bf):
    for y, x in zip(symbList_corr_y,symbList_corr_x):
            try:
                eg_test = engle_granger(df_bf[y], df_bf[x], trend='ctt', lags=None, max_lags=10, method='aic')
                print(f'{y} - {x} : p-value = {eg_test.pvalue}')
                if eg_test.pvalue < significance_level:
                    coint_pairs.append((y, x, eg_test.pvalue))
            except:
                print(f' Nans detected. The pair: {y} - {x} will be skipped.')
    return coint_pairs

find_cointegrated_pairs(df_bf)
print(f'All the selected pairs with p-value lower or equal: {significance_level} are: ')
for c, pair in enumerate(coint_pairs, 1):
    print(f'Pair : {pair[0]} - {pair[1]}, pvalue: {pair[2]}')

df_coint=pd.DataFrame(coint_pairs)
df_coint.columns = ['y','x','pvalue']
df_coint.to_csv('coint_pairs_tse1.csv')



#calculate ratios between two series af-covid
df_af= pd.read_excel('all af1 covid.xlsx',index_col = 'Dates')
df_af_log = np.log(df_af)
df_af_log_diff=df_af_log.diff()
symbList_coint_y = df_coint['y'].tolist()
symbList_coint_x = df_coint['x'].tolist()
coint_pairs_log_diff_split_af = []
def find_pairs(df_af_log_diff):
    for y,x in zip(symbList_coint_y,symbList_coint_x):
            try:
                mean = np.average(df_af_log_diff[1:][y] / df_af_log_diff[1:][x])
                print(f'{y} - {x} : ratio = {mean}')
            except:
                print(f'Nans detected. The pair: {y} - {x} will be skipped.')
    return coint_pairs_log_diff_split_af

find_pairs(df_af_log_diff)

df_af_pairs_analysis=pd.DataFrame(coint_pairs_log_diff_split_af)
df_af_pairs_analysis = ['y','x','ratio_mean']
df_af_pairs_analysis.to_csv('af_analysis_pairs_tse1.csv')

